<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>3DPrintCraft | –ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { font-family: sans-serif; background: #000c18; color: white; padding: 20px; text-align: center; }
        .card { background: #001f3f; padding: 20px; border-radius: 12px; border: 1px solid #00d4ff; max-width: 400px; margin: auto; }
        input, textarea, button { width: 100%; padding: 10px; margin: 8px 0; border-radius: 5px; border: none; box-sizing: border-box; }
        button { background: #00d4ff; color: #000; font-weight: bold; cursor: pointer; }
        .item { background: #002b53; padding: 10px; margin-top: 5px; display: flex; justify-content: space-between; border-radius: 5px; font-size: 14px; }
    </style>
</head>
<body>

<div class="card">
    <h2>üõ† –î–æ–¥–∞—Ç–∏ —Ç–æ–≤–∞—Ä</h2>
    <input type="text" id="name" placeholder="–ù–∞–∑–≤–∞ –º–æ–¥–µ–ª—ñ">
    <textarea id="desc" placeholder="–û–ø–∏—Å (–º–∞—Ç–µ—Ä—ñ–∞–ª, —Ä–æ–∑–º—ñ—Ä)"></textarea>
    <input type="number" id="price" placeholder="–¶—ñ–Ω–∞ (–≥—Ä–Ω)">
    <input type="text" id="img" placeholder="–ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ñ–æ—Ç–æ (URL)">
    <button onclick="saveToCloud()">–û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ –Ω–∞ —Å–∞–π—Ç</button>
    <hr>
    <div id="list">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–æ–≤–∞—Ä—ñ–≤...</div>
</div>

<script>
    // –¢–í–û–á –ö–õ–Æ–ß–Ü –í–ñ–ï –¢–£–¢
    const supabaseUrl = 'https://kkyrhxuwllawvfqltgil.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImtreXJoeHV3bGxhd3ZmcWx0Z2lsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg0MDMzNzUsImV4cCI6MjA4Mzk3OTM3NX0.r8DPctn9mF9EFLbU5_5cLrBcN-7oIo8p02BktKxKSVM';
    const _supabase = supabase.createClient(supabaseUrl, supabaseKey);

    // –§–£–ù–ö–¶–Ü–Ø –ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø
    async function saveToCloud() {
        const name = document.getElementById('name').value;
        const desc = document.getElementById('desc').value;
        const price = document.getElementById('price').value;
        const img = document.getElementById('img').value || 'https://via.placeholder.com/150';

        if(!name || !price) return alert("–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É —Ç–∞ —Ü—ñ–Ω—É!");

        const { error } = await _supabase.from('products').insert([{ 
            name: name, 
            desc: desc, 
            price: parseInt(price), 
            img: img 
        }]);
        
        if (error) {
            alert("–ü–æ–º–∏–ª–∫–∞: " + error.message);
        } else {
            alert("–£—Å–ø—ñ—à–Ω–æ –¥–æ–¥–∞–Ω–æ!");
            location.reload();
        }
    }

    // –ü–û–ö–ê–ó –°–ü–ò–°–ö–£ –¢–û–í–ê–†–Ü–í
    async function loadList() {
        const { data: products } = await _supabase.from('products').select('*');
        const listDiv = document.getElementById('list');
        listDiv.innerHTML = "<h3>–¢–æ–≤–∞—Ä–∏ –≤ –±–∞–∑—ñ:</h3>";
        if(products) {
            products.forEach(p => {
                listDiv.innerHTML += `
                    <div class="item">
                        <span>${p.name} - ${p.price}–≥—Ä–Ω</span>
                        <button onclick="deleteProd(${p.id})" style="width:auto; background:red; color:white; padding:2px 5px;">X</button>
                    </div>`;
            });
        }
    }

    async function deleteProd(id) {
        if(confirm("–í–∏–¥–∞–ª–∏—Ç–∏ —Ç–æ–≤–∞—Ä?")) {
            await _supabase.from('products').delete().eq('id', id);
            location.reload();
        }
    }

    loadList();
</script>

</body>
</html>
